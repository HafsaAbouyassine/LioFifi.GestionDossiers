<Page
    x:Class="CPAM.GestionDossiers.PageNouveauDossier"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:CPAM.GestionDossiers"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Nouveau dossier"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <Page.Resources>
        <!--  Style pour les cartes  -->
        <DropShadowEffect
            x:Key="ShadowEffect"
            BlurRadius="10"
            Opacity="0.2"
            ShadowDepth="2" />

        <!--  Style pour les champs de formulaire  -->
        <Style x:Key="FormFieldStyle" TargetType="Grid">
            <Setter Property="Margin" Value="0,10" />
        </Style>

        <Style x:Key="FormLabelStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#FF1E3A5F" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Margin" Value="0,0,0,5" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style x:Key="FormTextBoxStyle" TargetType="TextBox">
            <Setter Property="Padding" Value="10" />
            <Setter Property="BorderBrush" Value="#FFA7C4FF" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Background" Value="White" />
            <Setter Property="Foreground" Value="#FF2F4F4F" />
            <Setter Property="FontSize" Value="14" />
        </Style>

        <Style x:Key="FormComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Padding" Value="8" />
        </Style>

        <!--  Correction : Définir le style de DatePicker avec TargetType="DatePicker" sans BasedOn  -->
        <Style x:Key="FormDatePickerStyle" TargetType="DatePicker">
            <Setter Property="Padding" Value="8" />
            <Setter Property="BorderBrush" Value="#FFA7C4FF" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Background" Value="White" />
            <Setter Property="Foreground" Value="#FF2F4F4F" />
            <Setter Property="FontSize" Value="14" />
        </Style>

        <!--  Style pour les boutons  -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF1E3A5F" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="15,8" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Margin" Value="10,0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Effect" Value="{StaticResource ShadowEffect}" />
        </Style>
    </Page.Resources>

    <Grid Background="#FFF5F9FF">
        <ScrollViewer Padding="20" VerticalScrollBarVisibility="Auto">
            <Border
                Padding="25"
                Background="White"
                CornerRadius="10"
                Effect="{StaticResource ShadowEffect}">
                <StackPanel>
                    <!--  En-tête  -->
                    <TextBlock
                        Margin="0,0,0,20"
                        FontSize="22"
                        FontWeight="Bold"
                        Foreground="#FF1E3A5F"
                        Text="NOUVEAU DOSSIER" />

                    <!--  Formulaire  -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Colonne gauche  -->
                        <Grid
                            Grid.Row="0"
                            Grid.Column="0"
                            Style="{StaticResource FormFieldStyle}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Style="{StaticResource FormLabelStyle}" Text="Nom de l'assuré" />
                            <TextBox
                                x:Name="txtNomBeneficiaire"
                                Grid.Row="1"
                                Style="{StaticResource FormTextBoxStyle}"
                                Text="{Binding Dossier.NomAssure, Mode=TwoWay}" />
                        </Grid>

                        <Grid
                            Grid.Row="2"
                            Grid.Column="0"
                            Style="{StaticResource FormFieldStyle}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="141*" />
                                <ColumnDefinition Width="187*" />
                                <ColumnDefinition Width="27*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid
                                Grid.Row="1"
                                Grid.Column="0"
                                Style="{StaticResource FormFieldStyle}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <TextBlock
                                    Grid.ColumnSpan="2"
                                    VerticalAlignment="Top"
                                    Style="{StaticResource FormLabelStyle}"
                                    Text="Numéro d'identité" />
                                <TextBox
                                    x:Name="txtNumeroDossier"
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    Style="{StaticResource FormTextBoxStyle}"
                                    Text="{Binding Dossier.NumeroDossier, Mode=TwoWay}" />
                                <!--  Icône d'information  -->
                                <Border
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    Width="22"
                                    Height="22"
                                    Margin="8,0,0,0"
                                    VerticalAlignment="Center"
                                    Background="#FFCCE5FF"
                                    CornerRadius="11"
                                    ToolTip="C'est le numéro de la carte de nationalité ou du titre de séjour.">
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontSize="14"
                                        FontWeight="Bold"
                                        Foreground="#FF1E3A5F"
                                        Text="!" />
                                </Border>
                            </Grid>
                        </Grid>

                        <Grid
                            Grid.Row="1"
                            Grid.Column="0"
                            Style="{StaticResource FormFieldStyle}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Style="{StaticResource FormLabelStyle}" Text="Date de naissance" />
                            <DatePicker
                                x:Name="dateNaissance"
                                Grid.Row="1"
                                SelectedDate="{Binding Dossier.DateNaissance, Mode=TwoWay}"
                                Style="{StaticResource FormDatePickerStyle}" />
                        </Grid>

                        <!--  Colonne droite  -->
                        <Grid
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="20,10,0,10"
                            Style="{StaticResource FormFieldStyle}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Style="{StaticResource FormLabelStyle}" Text="Statut" />
                            <ComboBox
                                x:Name="status"
                                Grid.Row="1"
                                SelectedItem="{Binding Dossier.Statut, Mode=TwoWay}"
                                Style="{StaticResource FormComboBoxStyle}">
                                <ComboBoxItem>Nouveau</ComboBoxItem>
                                <ComboBoxItem>En cours</ComboBoxItem>
                                <ComboBoxItem>Terminé</ComboBoxItem>
                                <ComboBoxItem>En attente</ComboBoxItem>
                            </ComboBox>
                        </Grid>

                        <Grid
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="20,10,0,10"
                            Style="{StaticResource FormFieldStyle}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Style="{StaticResource FormLabelStyle}" Text="Catégorie" />
                            <ComboBox
                                x:Name="category"
                                Grid.Row="1"
                                SelectedItem="{Binding Dossier.Categorie, Mode=TwoWay}"
                                Style="{StaticResource FormComboBoxStyle}">
                                <ComboBoxItem>Médical</ComboBoxItem>
                                <ComboBoxItem>Hospitalisation</ComboBoxItem>
                                <ComboBoxItem>Pharmacie</ComboBoxItem>
                                <ComboBoxItem>Dentaire</ComboBoxItem>
                            </ComboBox>
                        </Grid>

                        <Grid
                            Grid.Row="2"
                            Grid.Column="1"
                            Margin="20,10,0,10"
                            Style="{StaticResource FormFieldStyle}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Style="{StaticResource FormLabelStyle}" Text="Agent responsable" />
                            <ComboBox
                                x:Name="agentResponsable"
                                Grid.Row="1"
                                SelectedItem="{Binding Dossier.AgentResponsable, Mode=TwoWay}"
                                Style="{StaticResource FormComboBoxStyle}">
                                <ComboBoxItem>Alice Martin</ComboBoxItem>
                                <ComboBoxItem>Bob Lefevre</ComboBoxItem>
                                <ComboBoxItem>Claire Dubois</ComboBoxItem>
                                <ComboBoxItem>David Moreau</ComboBoxItem>
                            </ComboBox>
                        </Grid>
                    </Grid>

                    <!--  Boutons d'action  -->
                    <StackPanel
                        Margin="0,30,0,0"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal">
                        <Button
                            Background="#FF7F9FBF"
                            Click="CancelNewFolder"
                            Command="{Binding CancelCommand}"
                            Content="Annuler"
                            Style="{StaticResource PrimaryButtonStyle}" />
                        <Button
                            Click="SaveNewFolder"
                            Command="{Binding SaveCommand}"
                            Content="Enregistrer"
                            Style="{StaticResource PrimaryButtonStyle}" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </ScrollViewer>
    </Grid>
</Page>
